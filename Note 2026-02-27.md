It's Saturday, I don't know if you will see this. We're in different time zones, so I'm sending you this update before I go to bed, expecting to work on it some more in my morning.

Progress thus far:

Some of the syntax of `grid` causes lots of accidental complexity from a traditional grammar perspective. This is not a bad thing, but, it must be observed that we need a staged approach instead of allowing CFG-based thinking to make building this compiler harder than need be.

So, I've built a pre-pass that uses OhmJS "lexical" rules (i.e. standard PEG, instead of OhmJS extensions such as space-skipping ("syntactic rules") to massage the `grid` source code and convert it to an internal form.

I used `t2t` (a script that uses OhmJS twice, once to parse, then to rewrite) to do the work. See `prepass.ohm` and `prepass.rwr`. This could probably be completely done in a traditional programming language (say, Python), but I find it a lot easier to write it this way. My approach is "get it right first, then optimize". Where "getting it right" means that it passes enough tests to make you feel comfortable (it doesn't imply theorem proving, etc.).

I expect that `grid.ohm` (the grammar) will be much simpler to write with these (minor) changes. I haven't written the grammar yet, that's next.

The `prepass.rwr` file contains _some_ rewrite mechanisms, but doesn't contain exactly what you asked about (propagation), as it isn't needed here.

github https://github.com/guitarvydas/grid (see README.md) - this repo /should/ contain everything that's needed (including ./pbp/ and t2t). You probably need to install some stuff and I've probably forgotten to mention all of the bits and pieces. (look in pbp/package.json)

The RWR doc is at https://github.com/guitarvydas/pbp-dev/blob/main/t2td/doc/rwr/RWR%20Spec.pdf. Propagation is dealt with using `% parameter` and scoping (` ⎡ ... ⎦`) and parameter interpolation (`⟪ ... ⟫` - N.B. those are different brackets than string interpolation `« ... »`).

Again, I'm still coming down the learning curve, so don't expect this stuff to actually be correct.

Likewise, I didn't grow up with git, and I keep forgetting to push various things. This all works fine on my machine, and I would hope that it simply works on your machine, too. Just clone and run `./@make`. I'm on MacOS, I haven't touched Windows for years. I expect it to work fine on Linux, too. If not, you know who to complain to :-).

